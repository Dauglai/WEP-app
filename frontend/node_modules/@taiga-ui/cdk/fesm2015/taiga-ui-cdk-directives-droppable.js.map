{"version":3,"file":"taiga-ui-cdk-directives-droppable.js","sources":["../../../projects/cdk/directives/droppable/droppable.directive.ts","../../../projects/cdk/directives/droppable/droppable.module.ts","../../../projects/cdk/directives/droppable/taiga-ui-cdk-directives-droppable.ts"],"sourcesContent":["import {Directive, ElementRef, Inject, Output, Self} from '@angular/core';\nimport {tuiPreventDefault, tuiTypedFromEvent} from '@taiga-ui/cdk/observables';\nimport {TuiDestroyService} from '@taiga-ui/cdk/services';\nimport {tuiIsPresent} from '@taiga-ui/cdk/utils/miscellaneous';\nimport {merge, Observable} from 'rxjs';\nimport {\n    distinctUntilChanged,\n    filter,\n    map,\n    startWith,\n    switchMap,\n    takeUntil,\n} from 'rxjs/operators';\n\n@Directive({\n    selector: '[tuiDroppableDropped], [tuiDroppableDragOverChange]',\n    providers: [TuiDestroyService],\n})\nexport class TuiDroppableDirective {\n    @Output()\n    readonly tuiDroppableDropped: Observable<DataTransfer>;\n\n    @Output()\n    readonly tuiDroppableDragOverChange: Observable<DataTransfer | null>;\n\n    constructor(\n        @Inject(ElementRef) {nativeElement}: ElementRef<HTMLElement>,\n        @Self() @Inject(TuiDestroyService) destroy$: Observable<void>,\n    ) {\n        this.tuiDroppableDropped = tuiTypedFromEvent(nativeElement, 'drop').pipe(\n            tuiPreventDefault(),\n            map(event => event.dataTransfer),\n            filter(tuiIsPresent),\n        );\n\n        this.tuiDroppableDragOverChange = tuiTypedFromEvent(\n            nativeElement,\n            'dragenter',\n        ).pipe(\n            switchMap(({target, dataTransfer}) =>\n                merge(\n                    tuiTypedFromEvent(nativeElement, 'dragleave').pipe(\n                        filter(event => event.target === target),\n                    ),\n                    tuiTypedFromEvent(nativeElement, 'drop'),\n                ).pipe(\n                    map(() => null),\n                    startWith(dataTransfer),\n                ),\n            ),\n            distinctUntilChanged((a, b) => (!!a && !!b) || (!a && !b)),\n        );\n\n        // Required by Drag and Drop API to stop redirecting\n        tuiTypedFromEvent(nativeElement, 'dragover')\n            .pipe(tuiPreventDefault(), takeUntil(destroy$))\n            .subscribe();\n    }\n}\n","import {NgModule} from '@angular/core';\n\nimport {TuiDroppableDirective} from './droppable.directive';\n\n@NgModule({\n    declarations: [TuiDroppableDirective],\n    exports: [TuiDroppableDirective],\n})\nexport class TuiDroppableModule {}\n","/**\n * Generated bundle index. Do not edit.\n */\n\nexport * from './index';\n"],"names":[],"mappings":";;;;;;;;;MAkBa,qBAAqB,CAAA;AAO9B,IAAA,WAAA,CACwB,EAAC,aAAa,EAA0B,EACzB,QAA0B,EAAA;AAE7D,QAAA,IAAI,CAAC,mBAAmB,GAAG,iBAAiB,CAAC,aAAa,EAAE,MAAM,CAAC,CAAC,IAAI,CACpE,iBAAiB,EAAE,EACnB,GAAG,CAAC,KAAK,IAAI,KAAK,CAAC,YAAY,CAAC,EAChC,MAAM,CAAC,YAAY,CAAC,CACvB,CAAC;QAEF,IAAI,CAAC,0BAA0B,GAAG,iBAAiB,CAC/C,aAAa,EACb,WAAW,CACd,CAAC,IAAI,CACF,SAAS,CAAC,CAAC,EAAC,MAAM,EAAE,YAAY,EAAC,KAC7B,KAAK,CACD,iBAAiB,CAAC,aAAa,EAAE,WAAW,CAAC,CAAC,IAAI,CAC9C,MAAM,CAAC,KAAK,IAAI,KAAK,CAAC,MAAM,KAAK,MAAM,CAAC,CAC3C,EACD,iBAAiB,CAAC,aAAa,EAAE,MAAM,CAAC,CAC3C,CAAC,IAAI,CACF,GAAG,CAAC,MAAM,IAAI,CAAC,EACf,SAAS,CAAC,YAAY,CAAC,CAC1B,CACJ,EACD,oBAAoB,CAAC,CAAC,CAAC,EAAE,CAAC,KAAK,CAAC,CAAC,CAAC,CAAC,IAAI,CAAC,CAAC,CAAC,MAAM,CAAC,CAAC,IAAI,CAAC,CAAC,CAAC,CAAC,CAC7D,CAAC;;AAGF,QAAA,iBAAiB,CAAC,aAAa,EAAE,UAAU,CAAC;aACvC,IAAI,CAAC,iBAAiB,EAAE,EAAE,SAAS,CAAC,QAAQ,CAAC,CAAC;AAC9C,aAAA,SAAS,EAAE,CAAC;KACpB;;mHAvCQ,qBAAqB,EAAA,IAAA,EAAA,CAAA,EAAA,KAAA,EAQlB,UAAU,EAAA,EAAA,EAAA,KAAA,EACF,iBAAiB,EAAA,IAAA,EAAA,IAAA,EAAA,CAAA,EAAA,MAAA,EAAA,EAAA,CAAA,eAAA,CAAA,SAAA,EAAA,CAAA,CAAA;uGAT5B,qBAAqB,EAAA,QAAA,EAAA,qDAAA,EAAA,OAAA,EAAA,EAAA,mBAAA,EAAA,qBAAA,EAAA,0BAAA,EAAA,4BAAA,EAAA,EAAA,SAAA,EAFnB,CAAC,iBAAiB,CAAC,EAAA,QAAA,EAAA,EAAA,EAAA,CAAA,CAAA;4FAErB,qBAAqB,EAAA,UAAA,EAAA,CAAA;kBAJjC,SAAS;AAAC,YAAA,IAAA,EAAA,CAAA;AACP,oBAAA,QAAQ,EAAE,qDAAqD;oBAC/D,SAAS,EAAE,CAAC,iBAAiB,CAAC;AACjC,iBAAA,CAAA;;0BASQ,MAAM;2BAAC,UAAU,CAAA;;0BACjB,IAAI;;0BAAI,MAAM;2BAAC,iBAAiB,CAAA;4CAP5B,mBAAmB,EAAA,CAAA;sBAD3B,MAAM;gBAIE,0BAA0B,EAAA,CAAA;sBADlC,MAAM;;;MCdE,kBAAkB,CAAA;;gHAAlB,kBAAkB,EAAA,IAAA,EAAA,EAAA,EAAA,MAAA,EAAA,EAAA,CAAA,eAAA,CAAA,QAAA,EAAA,CAAA,CAAA;iHAAlB,kBAAkB,EAAA,YAAA,EAAA,CAHZ,qBAAqB,CAAA,EAAA,OAAA,EAAA,CAC1B,qBAAqB,CAAA,EAAA,CAAA,CAAA;iHAEtB,kBAAkB,EAAA,CAAA,CAAA;4FAAlB,kBAAkB,EAAA,UAAA,EAAA,CAAA;kBAJ9B,QAAQ;AAAC,YAAA,IAAA,EAAA,CAAA;oBACN,YAAY,EAAE,CAAC,qBAAqB,CAAC;oBACrC,OAAO,EAAE,CAAC,qBAAqB,CAAC;AACnC,iBAAA,CAAA;;;ACPD;;AAEG;;;;"}