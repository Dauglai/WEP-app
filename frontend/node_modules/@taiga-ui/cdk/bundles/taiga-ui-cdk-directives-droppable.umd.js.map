{"version":3,"file":"taiga-ui-cdk-directives-droppable.umd.js","sources":["../../../projects/cdk/directives/droppable/droppable.directive.ts","../../../projects/cdk/directives/droppable/droppable.module.ts","../../../projects/cdk/directives/droppable/taiga-ui-cdk-directives-droppable.ts"],"sourcesContent":["import {Directive, ElementRef, Inject, Output, Self} from '@angular/core';\nimport {tuiPreventDefault, tuiTypedFromEvent} from '@taiga-ui/cdk/observables';\nimport {TuiDestroyService} from '@taiga-ui/cdk/services';\nimport {tuiIsPresent} from '@taiga-ui/cdk/utils/miscellaneous';\nimport {merge, Observable} from 'rxjs';\nimport {\n    distinctUntilChanged,\n    filter,\n    map,\n    startWith,\n    switchMap,\n    takeUntil,\n} from 'rxjs/operators';\n\n@Directive({\n    selector: '[tuiDroppableDropped], [tuiDroppableDragOverChange]',\n    providers: [TuiDestroyService],\n})\nexport class TuiDroppableDirective {\n    @Output()\n    readonly tuiDroppableDropped: Observable<DataTransfer>;\n\n    @Output()\n    readonly tuiDroppableDragOverChange: Observable<DataTransfer | null>;\n\n    constructor(\n        @Inject(ElementRef) {nativeElement}: ElementRef<HTMLElement>,\n        @Self() @Inject(TuiDestroyService) destroy$: Observable<void>,\n    ) {\n        this.tuiDroppableDropped = tuiTypedFromEvent(nativeElement, 'drop').pipe(\n            tuiPreventDefault(),\n            map(event => event.dataTransfer),\n            filter(tuiIsPresent),\n        );\n\n        this.tuiDroppableDragOverChange = tuiTypedFromEvent(\n            nativeElement,\n            'dragenter',\n        ).pipe(\n            switchMap(({target, dataTransfer}) =>\n                merge(\n                    tuiTypedFromEvent(nativeElement, 'dragleave').pipe(\n                        filter(event => event.target === target),\n                    ),\n                    tuiTypedFromEvent(nativeElement, 'drop'),\n                ).pipe(\n                    map(() => null),\n                    startWith(dataTransfer),\n                ),\n            ),\n            distinctUntilChanged((a, b) => (!!a && !!b) || (!a && !b)),\n        );\n\n        // Required by Drag and Drop API to stop redirecting\n        tuiTypedFromEvent(nativeElement, 'dragover')\n            .pipe(tuiPreventDefault(), takeUntil(destroy$))\n            .subscribe();\n    }\n}\n","import {NgModule} from '@angular/core';\n\nimport {TuiDroppableDirective} from './droppable.directive';\n\n@NgModule({\n    declarations: [TuiDroppableDirective],\n    exports: [TuiDroppableDirective],\n})\nexport class TuiDroppableModule {}\n","/**\n * Generated bundle index. Do not edit.\n */\n\nexport * from './index';\n"],"names":["tuiTypedFromEvent","tuiPreventDefault","map","filter","tuiIsPresent","switchMap","merge","startWith","distinctUntilChanged","takeUntil","ElementRef","TuiDestroyService","i0","Directive","Inject","Self","Output","NgModule"],"mappings":"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"}