{"version":3,"file":"taiga-ui-i18n-switch.js","sources":["../../../projects/i18n/switch/utils.ts","../../../projects/i18n/switch/language-switcher.service.ts","../../../projects/i18n/switch/language-switcher.providers.ts","../../../projects/i18n/switch/taiga-ui-i18n-switch.ts"],"sourcesContent":["import type {\n    TuiLanguage,\n    TuiLanguageLoader,\n    TuiLanguageName,\n} from '@taiga-ui/i18n/interfaces';\nimport {from, Observable, of} from 'rxjs';\nimport {map} from 'rxjs/operators';\n\nexport function tuiAsyncLoadLanguage(\n    language: TuiLanguageName | null,\n    loader: TuiLanguageLoader | null,\n    fallback: TuiLanguage,\n): Observable<TuiLanguage> {\n    return language && loader ? tuiLoadLanguage(language, loader) : of(fallback);\n}\n\nexport function tuiLoadLanguage(\n    language: TuiLanguageName,\n    loader: TuiLanguageLoader,\n): Observable<TuiLanguage> {\n    return from(normalizeCommonJSImport(loader(language))).pipe(\n        map((module: any) => module?.[`TUI_${language.toUpperCase()}_LANGUAGE`]),\n    );\n}\n\n// CommonJS `module.exports` is wrapped as `default` in ESModule.\nasync function normalizeCommonJSImport<T>(importPromise: Promise<T>): Promise<T> {\n    return importPromise.then((m: any) => m.default || m);\n}\n","import {Inject, Injectable, Optional} from '@angular/core';\nimport {LOCAL_STORAGE} from '@ng-web-apis/common';\nimport {\n    TuiLanguage,\n    TuiLanguageLoader,\n    TuiLanguageName,\n    TuiLanguageStorage,\n} from '@taiga-ui/i18n/interfaces';\nimport {\n    TUI_DEFAULT_LANGUAGE,\n    TUI_LANGUAGE_LOADER,\n    TUI_LANGUAGE_STORAGE_KEY,\n} from '@taiga-ui/i18n/tokens';\nimport {BehaviorSubject, Observable, of} from 'rxjs';\n\nimport {tuiAsyncLoadLanguage} from './utils';\n\n// @dynamic\n@Injectable({providedIn: `root`})\nexport class TuiLanguageSwitcher extends BehaviorSubject<Observable<TuiLanguage>> {\n    constructor(\n        @Inject(TUI_DEFAULT_LANGUAGE)\n        private readonly fallback: TuiLanguage,\n        @Inject(TUI_LANGUAGE_STORAGE_KEY)\n        private readonly key: string,\n        @Inject(LOCAL_STORAGE)\n        private readonly storage: TuiLanguageStorage,\n        @Optional()\n        @Inject(TUI_LANGUAGE_LOADER)\n        private readonly loader: TuiLanguageLoader | null,\n    ) {\n        super(tuiAsyncLoadLanguage(storage.getItem(key), loader, fallback));\n    }\n\n    get language(): TuiLanguageName {\n        return this.storage.getItem(this.key) || this.fallback.name;\n    }\n\n    setLanguage(language: TuiLanguageName): void {\n        this.storage.setItem(this.key, language);\n\n        this.next(tuiAsyncLoadLanguage(language, this.loader, this.fallback));\n    }\n\n    clear(): void {\n        this.storage.removeItem(this.key);\n\n        this.next(of(this.fallback));\n    }\n}\n","import type {Provider} from '@angular/core';\nimport {TuiLanguageLoader} from '@taiga-ui/i18n/interfaces';\nimport {TUI_LANGUAGE, TUI_LANGUAGE_LOADER} from '@taiga-ui/i18n/tokens';\n\nimport {TuiLanguageSwitcher} from './language-switcher.service';\n\nexport function tuiLanguageSwitcher(loader: TuiLanguageLoader): Provider[] {\n    return [\n        {\n            provide: TUI_LANGUAGE_LOADER,\n            useFactory: () => loader,\n        },\n        {\n            provide: TUI_LANGUAGE,\n            useExisting: TuiLanguageSwitcher,\n        },\n    ];\n}\n","/**\n * Generated bundle index. Do not edit.\n */\n\nexport * from './index';\n"],"names":[],"mappings":"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"}