{"version":3,"file":"taiga-ui-kit-components-routable-dialog.js","sources":["../../../projects/kit/components/routable-dialog/routable-dialog.component.ts","../../../projects/kit/components/routable-dialog/generate-dialogable-route.ts","../../../projects/kit/components/routable-dialog/routable-dialog.module.ts","../../../projects/kit/components/routable-dialog/taiga-ui-kit-components-routable-dialog.ts"],"sourcesContent":["import {ChangeDetectionStrategy, Component, Inject, Injector, Self} from '@angular/core';\nimport {ActivatedRoute, Router, UrlSegment} from '@angular/router';\nimport {TuiDestroyService} from '@taiga-ui/cdk';\nimport {TuiDialogService} from '@taiga-ui/core';\nimport {PolymorpheusComponent} from '@tinkoff/ng-polymorpheus';\nimport {takeUntil} from 'rxjs/operators';\n\n@Component({\n    selector: 'tui-routable-dialog',\n    template: '',\n    changeDetection: ChangeDetectionStrategy.OnPush,\n    providers: [TuiDestroyService],\n})\nexport class TuiRoutableDialogComponent {\n    constructor(\n        @Inject(ActivatedRoute) private readonly route: ActivatedRoute,\n        @Inject(Router) private readonly router: Router,\n        @Inject(TuiDialogService) dialogs: TuiDialogService,\n        @Inject(Injector) injector: Injector,\n        @Self() @Inject(TuiDestroyService) destroy$: TuiDestroyService,\n    ) {\n        dialogs\n            .open(\n                new PolymorpheusComponent(this.route.snapshot.data['dialog'], injector),\n                this.route.snapshot.data['dialogOptions'],\n            )\n            .pipe(takeUntil(destroy$))\n            .subscribe({\n                complete: () => this.navigateToParent(),\n            });\n    }\n\n    private navigateToParent(): void {\n        const isLazy = this.route.snapshot.data['isLazy'];\n\n        const backUrl = isLazy\n            ? this.getLazyLoadedBackUrl()\n            : this.route.snapshot.data['backUrl'];\n\n        void this.router.navigate([backUrl], {\n            relativeTo: this.route,\n        });\n    }\n\n    private getLazyLoadedBackUrl(): string {\n        const urlSegments: UrlSegment[] = this.route.parent?.snapshot.url || [];\n\n        return urlSegments.map(() => '..').join('/');\n    }\n}\n","import {Type} from '@angular/core';\nimport {Route} from '@angular/router';\nimport {TuiDialogOptions} from '@taiga-ui/core';\n\nimport {TuiRoutableDialogComponent} from './routable-dialog.component';\n\nexport function tuiGenerateDialogableRoute<I>(\n    component: Type<any>,\n    {path = ``, ...dialogOptions}: Partial<TuiDialogOptions<I>> & {path?: string} = {},\n): Route {\n    return {\n        path,\n        component: TuiRoutableDialogComponent,\n        data: {\n            dialog: component,\n            backUrl: path\n                .split(`/`)\n                .map(() => `..`)\n                .join(`/`),\n            isLazy: path === ``,\n            dialogOptions,\n        },\n    };\n}\n","import {NgModule} from '@angular/core';\n\nimport {TuiRoutableDialogComponent} from './routable-dialog.component';\n\n@NgModule({\n    declarations: [TuiRoutableDialogComponent],\n    exports: [TuiRoutableDialogComponent],\n})\nexport class TuiRoutableDialogModule {}\n","/**\n * Generated bundle index. Do not edit.\n */\n\nexport * from './index';\n"],"names":[],"mappings":"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"}